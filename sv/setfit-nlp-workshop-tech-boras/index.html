<!doctype html><html lang=sv><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Träna Textklassificerare med få Exempel: SetFit Few-Shot Learning Tutorial - Pine Grove Interactive</title><meta name=Description content="Lär dig bygga textklassificerare med endast ett fåtal träningsexempel genom SetFit och Transformer-modeller. Ett perfekt första AI-projekt för företag. Praktisk handledning från Tech Borås AI Lab Workshop 2."><meta property="og:url" content="https://pgi.dev/sv/setfit-nlp-workshop-tech-boras/">
<meta property="og:site_name" content="Pine Grove Interactive"><meta property="og:title" content="Kraftfull NLP med SetFit och Few-Shot Learning"><meta property="og:description" content="Lär dig bygga textklassificerare med endast ett fåtal träningsexempel genom SetFit och Transformer-modeller. Ett perfekt första AI-projekt för företag. Praktisk handledning från Tech Borås AI Lab Workshop 2."><meta property="og:locale" content="sv"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-09-10T15:00:00+01:00"><meta property="article:modified_time" content="2025-11-29T11:49:04+01:00"><meta property="og:image" content="https://pgi.dev/images/tree.svg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://pgi.dev/images/tree.svg"><meta name=twitter:title content="Kraftfull NLP med SetFit och Few-Shot Learning"><meta name=twitter:description content="Lär dig bygga textklassificerare med endast ett fåtal träningsexempel genom SetFit och Transformer-modeller. Ett perfekt första AI-projekt för företag. Praktisk handledning från Tech Borås AI Lab Workshop 2."><meta name=application-name content="Pine Grove Interactive"><meta name=apple-mobile-web-app-title content="Pine Grove Interactive"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/images/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://pgi.dev/sv/setfit-nlp-workshop-tech-boras/><link rel=prev href=https://pgi.dev/sv/intro-to-ml-workshop-tech-boras/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Kraftfull NLP med SetFit och Few-Shot Learning","inLanguage":"sv","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/pgi.dev\/sv\/setfit-nlp-workshop-tech-boras\/"},"image":["https:\/\/pgi.dev\/images\/apple-touch-icon.png"],"genre":"posts","wordcount":1492,"url":"https:\/\/pgi.dev\/sv\/setfit-nlp-workshop-tech-boras\/","datePublished":"2025-09-10T15:00:00+01:00","dateModified":"2025-11-29T11:49:04+01:00","publisher":{"@type":"Organization","name":"xxxx","logo":"https:\/\/pgi.dev\/images\/tree.svg"},"author":{"@type":"Person","name":"Kristoffer Johansson"},"description":"Lär dig bygga textklassificerare med endast ett fåtal träningsexempel genom SetFit och Transformer-modeller. Ett perfekt första AI-projekt för företag. Praktisk handledning från Tech Borås AI Lab Workshop 2."}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><script defer src=https://cloud.umami.is/script.js data-website-id=6621ff6c-2172-46d3-96e6-c04c97e6890f></script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/sv/ title="Pine Grove Interactive"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/logo-pgi-dev.svg data-srcset="/images/logo-pgi-dev.svg, /images/logo-pgi-dev.svg 1.5x, /images/logo-pgi-dev.svg 2x" data-sizes=auto alt=Home title=Home></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/sv/posts/>Blogg </a><a class=menu-item href=/sv/offer/>Vårt Erbjudande </a><a class=menu-item href=/sv/about/>Om oss </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item language" title="Välj Språk">Svenska<i class="fas fa-chevron-right fa-fw" aria-hidden=true></i>
<select class=language-select id=language-select-desktop onchange="location=this.value"><option value=/sv/setfit-nlp-workshop-tech-boras/ selected>Svenska</option><option value=/setfit-nlp-workshop-tech-boras/>English</option></select>
</a><span class="menu-item search" id=search-desktop><input type=text placeholder="Sök titlar eller innehåll..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Sök><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Rensa><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Byt Tema"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/sv/ title="Pine Grove Interactive"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/logo-pgi-dev.svg data-srcset="/images/logo-pgi-dev.svg, /images/logo-pgi-dev.svg 1.5x, /images/logo-pgi-dev.svg 2x" data-sizes=auto alt=/images/logo-pgi-dev.svg title=/images/logo-pgi-dev.svg></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Sök titlar eller innehåll..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Sök><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Rensa><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Avbryt</a></div><a class=menu-item href=/sv/posts/ title>Blogg</a><a class=menu-item href=/sv/offer/ title>Vårt Erbjudande</a><a class=menu-item href=/sv/about/ title>Om oss</a><a href=javascript:void(0); class="menu-item theme-switch" title="Byt Tema">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class=menu-item title="Välj Språk">Svenska<i class="fas fa-chevron-right fa-fw" aria-hidden=true></i>
<select class=language-select onchange="location=this.value"><option value=/sv/setfit-nlp-workshop-tech-boras/ selected>Svenska</option><option value=/setfit-nlp-workshop-tech-boras/>English</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Innehåll</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class=single-title>Kraftfull NLP med SetFit och Few-Shot Learning</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://www.linkedin.com/in/kristoffer-johansson/ title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Kristoffer Johansson</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2025-09-10>2025-09-10</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1492 ord&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;8 minuter&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Innehåll</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#utmaningen-med-begränsad-mängd-träningsdata>Utmaningen med begränsad mängd träningsdata</a></li><li><a href=#hur-transformers-förändrade-nlp>Hur Transformers förändrade NLP</a></li><li><a href=#förstå-semantisk-likhet-i-text>Förstå semantisk likhet i text</a></li><li><a href=#setfit-few-shot-learning-för-textklassificering>SetFit: Few-Shot Learning för Textklassificering</a></li><li><a href=#bygga-en-textklassificerare-med-setfit>Bygga en textklassificerare med SetFit</a><ul><li><a href=#installation>Installation</a></li><li><a href=#komplett-träningspipeline>Komplett Träningspipeline</a></li><li><a href=#vad-denna-kod-gör>Vad denna kod gör</a></li></ul></li><li><a href=#köra-lokalt-med-gpu>Köra lokalt med GPU</a><ul><li><a href=#lokal-vs-molnutveckling>Lokal vs Molnutveckling</a></li><li><a href=#alternativ-kaggle-notebooks>Alternativ: Kaggle Notebooks</a></li></ul></li><li><a href=#kom-igång-med-few-shot-nlp>Kom igång med few-shot NLP</a></li><li><a href=#nlp--ai-konsult-i-borås>NLP & AI-konsult i Borås</a></li></ul></nav></div></div><div class=content id=content><p>Den 9 september genomförde jag den andra workshopen i AI Lab-serien på Högskolan i Borås. Den här gången tacklade vi ett vanligt affärsproblem som du stöter på hela tiden när du startar ett AI-projekt: Du har data, men den är omärkt. Detta inlägg visar hur man kan hantera denna utmaning med hjälp av few-shot learning.</p><figure><a class=lightgallery href=/setfit-nlp-workshop-tech-boras/tech-boras-workshop-2.webp title=/setfit-nlp-workshop-tech-boras/tech-boras-workshop-2.webp data-thumbnail=/setfit-nlp-workshop-tech-boras/tech-boras-workshop-2.webp data-sub-html="<h2>Workshop om Transformers och SetFit på Högskolan i Borås, 9 september</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/setfit-nlp-workshop-tech-boras/tech-boras-workshop-2.webp data-srcset="/setfit-nlp-workshop-tech-boras/tech-boras-workshop-2.webp, /setfit-nlp-workshop-tech-boras/tech-boras-workshop-2.webp 1.5x, /setfit-nlp-workshop-tech-boras/tech-boras-workshop-2.webp 2x" data-sizes=auto alt=/setfit-nlp-workshop-tech-boras/tech-boras-workshop-2.webp width=1280 height=720></a><figcaption class=image-caption>Workshop om Transformers och SetFit på Högskolan i Borås, 9 september</figcaption></figure><p>Moderna NLP-verktyg (Natural Language Processing) som SetFit gör att few-shot learning är praktiskt ganska enkelt med kod som du kan köra lokalt på din egen hårdvara. Små språkmodeller som BERT-varianter är lätta nog att köra på konsument-GPU:er, vilket gör avancerad NLP tillgänglig för dig utan beroende på molninfrastruktur eller återkommande kostnader. Det här är ett utmärkt första AI/ML projekt för företag som vill komma igång med ett datadrivet arbetssätt!</p><h2 id=utmaningen-med-begränsad-mängd-träningsdata>Utmaningen med begränsad mängd träningsdata</h2><p>Textklassificering löser verkliga affärsproblem. För att nämna några, du kan: sortera supportärenden efter prioritet, filtrera bort skräppost, dirigera kundförfrågningar till rätt avdelning, analysera sentiment (vad folk tycker) i produktrecensioner</p><p>Ett traditionellt tillvägagångssätt för maskininlärning kräver tusentals märkta exempel i ett så kallat dataset. Det betyder att du behöver någon som manuellt märker upp 5 000+ e-postmeddelanden som &ldquo;skräppost&rdquo; eller &ldquo;inte skräppost&rdquo; innan träningen av en modell kan börjar. Det kan vara dyrt och långsamt (och tråkigt) vilket betyder att de flesta organisationer inte har tusentals förmärkta exempel liggandes.</p><p>Det är här SetFit-metoden kommer in: den använder kraftfulla förtränade transformer-modeller som vi finjusterar på så lite som två exempel per klass. Mycket lättare att fixa än 5000 exempel!</p><h2 id=hur-transformers-förändrade-nlp>Hur Transformers förändrade NLP</h2><p>Transformer-modeller som BERT revolutionerade naturlig språkbehandling genom att förstå ordkontext. Till skillnad från äldre metoder som behandlar ord som isolerade tokens, fångar BERT betydelse baserat på omgivande ord.</p><p>Ta en titt på dessa meningar:</p><ul><li>&ldquo;Han cyklade till jobbet.&rdquo;</li><li>&ldquo;Han körde sin bil till jobbet.&rdquo;</li><li>&ldquo;Peter bestämde sig för att ta cykeln till stranden.&rdquo;</li></ul><p>BERT förstår att &ldquo;cyklade&rdquo; och &ldquo;cykeln&rdquo; relaterar till samma koncept, medan &ldquo;körde sin bil&rdquo; representerar ett annat transportsätt. Denna kontextuella förståelse är vad som gör modern NLP kraftfull. Och det som är extra bra är att det finns open-source plattformar som <a href=https://huggingface.co/ target=_blank rel="noopener noreffer">HuggingFace</a>
som är fyllt med dessa små, förtränade BERT-modeller som redan kan mycket om vår värld. Vi behöver bara tillhandahålla några exempel på vår uppgift för att träna om modellerna till att bli bra på det vi vill.</p><h2 id=förstå-semantisk-likhet-i-text>Förstå semantisk likhet i text</h2><p>I vilken kontext du läser en text spelar roll för konceptet &ldquo;likhet&rdquo;. Huruvida två meningar är &ldquo;lika&rdquo; beror helt och hållet på vad det är du mäter. Om vi till exempel tittar från perspektivet kollektivtrafik så kanske vi är intresserade av att veta vilket transportmedel det är som nämnts i texten. Då kan vi föresetälla oss att exempel kan paras ihop på det här sättet:</p><p><strong>Negativt par</strong> (olika transportmedel):</p><ul><li>&ldquo;Han cyklade till jobbet.&rdquo;</li><li>&ldquo;Han körde sin bil till jobbet.&rdquo;</li></ul><p><strong>Positivt par</strong> (samma transportmedel):</p><ul><li>&ldquo;Han cyklade till jobbet.&rdquo;</li><li>&ldquo;Peter bestämde sig för att ta cykeln till stranden.&rdquo;</li></ul><p><strong>Negativt par</strong> (olika transportmedel):</p><ul><li>&ldquo;Peter bestämde sig för att ta cykeln till stranden.&rdquo;</li><li>&ldquo;Han körde sin bil till jobbet.&rdquo;</li></ul><p>Men om vi istället är intresserade av att veta vart någon är på väg, då skulle vi behöva para ihop exemplen på ett helt annat sätt. Det här är viktigt eftersom att transformer-modeller lär sig dessa kontextuella relationer från massiva dataset när de tränades för första gången. Det betyder att modellerna har sett data som kanske inte överensstämmer exakt med vad det är du vill mäta! Och det är här som SetFit kommer in i bilden.</p><h2 id=setfit-few-shot-learning-för-textklassificering>SetFit: Few-Shot Learning för Textklassificering</h2><p>SetFit kombinerar förtränade Transformer-modeller tillsammans med en effektiv finjustering på ditt problem utifrån det perspektiv du vill anama. Det vill säga är det intressant att veta transportmedel eller destination? Och tack vare SetFit kan vi uppnå väldigt hög noggrannhet med endast 2-16 märkta exempel.</p><p>SetFit fungerar i två steg:</p><ol><li><strong>Kontrastiv inlärning</strong>: Träna på meningspar för att lära sig vilka exempel som är lika och vilka som är olika</li><li><strong>Klassificeringshuvud</strong>: Träna en enkel klassificerare ovanpå de inlärda inbäddningarna</li></ol><p>Att göra det på detta sättet utnyttjar den stora kunskapen som redan finns inbakad i transformers-modeller. Du lär inte modellen språk och koncept från grunden. Istället så lär du den din specifika klassificeringsuppgift med hjälp av språkförståelsen som modellen redan har.</p><p>Det ger oss snabba, lätta, produktionsklara textklassificerare som är tränade på en bråkdel av den data som traditionella metoder kräver.</p><h2 id=bygga-en-textklassificerare-med-setfit>Bygga en textklassificerare med SetFit</h2><p>Detta exempel är baserat på workshop-repositoriet: <a href=https://github.com/krjoha/ai-lab-setfit target=_blank rel="noopener noreffer">github.com/krjoha/ai-lab-setfit</a></p><p>Om du vill se hela exemplet kan du titta i en av de notebooks i repositoriet. Här är ett kodexempel därifrån:</p><h3 id=installation>Installation</h3><p>Använd <code>uv</code> för att skapa en virtuell python-miljö.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Skapa en virtuell miljö i en .venv-mapp och installera alla projektberoenden</span>
</span></span><span class=line><span class=cl>uv sync
</span></span></code></pre></td></tr></table></div></div><h3 id=komplett-träningspipeline>Komplett Träningspipeline</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datasets</span> <span class=kn>import</span> <span class=n>load_dataset</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>setfit</span> <span class=kn>import</span> <span class=n>SetFitModel</span><span class=p>,</span> <span class=n>Trainer</span><span class=p>,</span> <span class=n>TrainingArguments</span><span class=p>,</span> <span class=n>sample_dataset</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ladda Amazon Massive Intent-datasetet (svenska)</span>
</span></span><span class=line><span class=cl><span class=n>train_dataset</span> <span class=o>=</span> <span class=n>load_dataset</span><span class=p>(</span><span class=s2>&#34;SetFit/amazon_massive_intent_sv-SE&#34;</span><span class=p>,</span> <span class=n>split</span><span class=o>=</span><span class=s2>&#34;train&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>test_dataset</span> <span class=o>=</span> <span class=n>load_dataset</span><span class=p>(</span><span class=s2>&#34;SetFit/amazon_massive_intent_sv-SE&#34;</span><span class=p>,</span> <span class=n>split</span><span class=o>=</span><span class=s2>&#34;test&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Sampla bara 1 exempel per klass (60 exempel från 60 intent-klasser)</span>
</span></span><span class=line><span class=cl><span class=n>train_sample</span> <span class=o>=</span> <span class=n>sample_dataset</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>train_dataset</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>label_column</span><span class=o>=</span><span class=s2>&#34;label&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>num_samples</span><span class=o>=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ladda en förtränad inbäddningsmodell</span>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>SetFitModel</span><span class=o>.</span><span class=n>from_pretrained</span><span class=p>(</span><span class=s2>&#34;nomic-ai/modernbert-embed-base&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Konfigurera träning</span>
</span></span><span class=line><span class=cl><span class=n>args</span> <span class=o>=</span> <span class=n>TrainingArguments</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Initiera tränare</span>
</span></span><span class=line><span class=cl><span class=n>trainer</span> <span class=o>=</span> <span class=n>Trainer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>args</span><span class=o>=</span><span class=n>args</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>train_dataset</span><span class=o>=</span><span class=n>train_sample</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>eval_dataset</span><span class=o>=</span><span class=n>test_dataset</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>metric</span><span class=o>=</span><span class=s1>&#39;accuracy&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Träna modellen</span>
</span></span><span class=line><span class=cl><span class=n>trainer</span><span class=o>.</span><span class=n>train</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Utvärdera på testuppsättning</span>
</span></span><span class=line><span class=cl><span class=n>results</span> <span class=o>=</span> <span class=n>trainer</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=n>test_dataset</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Noggrannhet: </span><span class=si>{</span><span class=n>results</span><span class=p>[</span><span class=s1>&#39;accuracy&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.2%</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Gör förutsägelser på ny svensk text</span>
</span></span><span class=line><span class=cl><span class=n>predictions</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Släck lampan&#34;</span><span class=p>,</span>           <span class=c1># Släck lampan</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;spela vikingarna&#34;</span><span class=p>,</span>       <span class=c1># Spela Vikingarna (musik)</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;starta dammsugaren&#34;</span><span class=p>,</span>     <span class=c1># Starta dammsugaren</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>predictions</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=vad-denna-kod-gör>Vad denna kod gör</h3><ol><li><strong>Dataset-inläsning</strong>: Ladda Amazon Massive Intent-datasetet med 60 olika intent-klasser på svenska</li><li><strong>Few-shot sampling</strong>: Sampla bara 1 exempel per klass (60 totalt exempel från 11 514 tillgängliga)</li><li><strong>Modellinitiering</strong>: Ladda en förtränad flerspråkig inbäddningsmodell</li><li><strong>Träning</strong>: Tränaren genererar meningspar och finjusterar modellen</li><li><strong>Utvärdering</strong>: Testa noggrannhet på 2 974 osedda exempel</li><li><strong>Prediktion</strong>: Klassificera nya svenska röstassistent-kommandon</li></ol><p>Med endast 60 exempel totalt (1 per klass) så når denna modell en tillräckligt hög noggrannhet för att bli användbar på så kallad &ldquo;avsiktsklassificering&rdquo;. Traditionella tillvägagångssätt skulle som sagt behöva tusentals exempel per klass för att uppnå liknande resultat.</p><h2 id=köra-lokalt-med-gpu>Köra lokalt med GPU</h2><p>Små språkmodeller som BERT är lätta nog att köra på konsument-GPU:er. Till skillnad från stora språkmodeller kräver små modeller som <code>modernbert-embed-base</code> endast några få gigabyte GPU-minne.</p><p>Träning av Transformer-modeller behöver GPU-acceleration. Även med SetFits effektivitet är CPU-träning ibland långsam och opraktisk. Därför är det bra att nyttja din datorns GPU, om det finns en sådan. Det kan du kontrollera genom att köra:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Verifiera att NVIDIA GPU upptäcks</span>
</span></span><span class=line><span class=cl>nvidia-smi
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># För Macbook med Apple Silicon (M1/M2/M3/M4/M5)</span>
</span></span><span class=line><span class=cl><span class=c1># PyTorch kommer automatiskt upptäcka och använda MPS (Metal Performance Shaders)</span>
</span></span></code></pre></td></tr></table></div></div><p>Om du har en NVIDIA GPU med CUDA-stöd eller en Macbook med Apple Silicon kommer PyTorch att använda hårdvaruacceleration automatiskt. Träningskoden här ovanför med 60 exempel tar ett par sekunder istället för flera timmar med endast CPU.</p><h3 id=lokal-vs-molnutveckling>Lokal vs Molnutveckling</h3><p>Att köra lokalt ger dig kontroll. Inga sessions-timeouts. Inga slumpmässiga frånkopplingar. Arbeta direkt med lokala dataset. Din miljö består mellan sessioner.</p><p>Men om du inte har lokal GPU-åtkomst så tillhandahåller Kaggle gratis GPU-notebooks.</p><h3 id=alternativ-kaggle-notebooks>Alternativ: Kaggle Notebooks</h3><p>Kaggle erbjuder gratis GPU i deras notebook-miljö. Men det kräver ett registrerat konto + telefonverifiering för att förhindra missbruk. I utbyte får du tillgång till en Nvidia T4 GPU.</p><p><strong>Telefonverifiering:</strong></p><ol><li>Logga in på ditt konto på <a href=https://www.kaggle.com/settings target=_blank rel="noopener noreffer">kaggle.com/settings</a></li><li>Följ instruktionerna för att lägga till ditt telefonnummer</li><li>Efter verifiering får dina notebooks internetåtkomst och GPU-stöd</li></ol><p><strong>Aktivera GPU:</strong></p><ol><li>Öppna Kaggle Notebook</li><li>Klicka <strong>Settings</strong> → <strong>Accelerator</strong> → <strong>GPU T4 x2</strong> (undvik P100, den är äldre)</li><li>Din session har nu GPU-acceleration</li></ol><p><strong>Installera SetFit:</strong></p><ol><li>Kör första cellen för att starta din session</li><li>Klicka <strong>Add-ons</strong> → <strong>Install Dependencies</strong></li><li>Klistra in: <code>pip install setfit</code></li><li>Klicka <strong>Run</strong>, sedan <strong>Save</strong></li></ol><p>Det finns en version av workshop-notebook:en på Kaggle med dessa paket förkonfigurerade.</p><h2 id=kom-igång-med-few-shot-nlp>Kom igång med few-shot NLP</h2><p>SetFit gör det möjligt att lösa riktiga affärsproblem med NLP utan att behöva tusentals märkta exempel. Eftersom förtränade transformer-modeller redan förstår språk så behöver du bara lära dem din specifika uppgift. Det kräver betydligt mindre data än att träna från grunden. Ett utmärk första projekt!</p><p>Vill du testa själv? Klona workshop-repositoriet och träna din första few-shot klassificerare:</p><p><strong>Repository</strong>: <a href=https://github.com/krjoha/ai-lab-setfit target=_blank rel="noopener noreffer">github.com/krjoha/ai-lab-setfit</a></p><p>Du kan ha en fungerande textklassificerare igång på under 10 minuter. Och det är gratis att köra lokalt om du har en GPU i din dator!</p><figure><a class=lightgallery href=/setfit-nlp-workshop-tech-boras/ceo.webp title=/setfit-nlp-workshop-tech-boras/ceo.webp data-thumbnail=/setfit-nlp-workshop-tech-boras/ceo.webp data-sub-html="<h2>Kristoffer Johansson, föreläsare och skapare av AI Lab konceptet på Tech Borås</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/setfit-nlp-workshop-tech-boras/ceo.webp data-srcset="/setfit-nlp-workshop-tech-boras/ceo.webp, /setfit-nlp-workshop-tech-boras/ceo.webp 1.5x, /setfit-nlp-workshop-tech-boras/ceo.webp 2x" data-sizes=auto alt=/setfit-nlp-workshop-tech-boras/ceo.webp width=1200 height=802></a><figcaption class=image-caption>Kristoffer Johansson, föreläsare och skapare av AI Lab konceptet på Tech Borås</figcaption></figure><h2 id=nlp--ai-konsult-i-borås>NLP & AI-konsult i Borås</h2><p>Denna workshop var en del av AI Lab-serien på Högskolan i Borås, fokuserad på praktisk AI och NLP för utvecklare. Jag tillhandahåller AI- och data engineer konsulting för företag i Borås och i hela Sverige. Om du behöver hjälp med att implementera NLP-lösningar eller vill utforska few-shot learning för ditt användningsfall, hör av dig.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Uppdaterad den 2025-11-29&nbsp;<a class=git-hash href=https://github.com/krjoha/pine-grove/commit/fd45129f1e1d174d51f61df278c0cd0e8519d7c4 target=_blank title="commit by Kristoffer Johansson(10258920+krjoha@users.noreply.github.com) fd45129f1e1d174d51f61df278c0cd0e8519d7c4: Blog post about SetFit (#5)">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>fd45129f</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Tillbaka</a></span>&nbsp;|&nbsp;<span><a href=/sv/>Hem</a></span></section></div><div class=post-nav><a href=/sv/intro-to-ml-workshop-tech-boras/ class=prev rel=prev title="Maskininlärningsworkshop i Borås"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Maskininlärningsworkshop i Borås</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://www.linkedin.com/in/kristoffer-johansson/ target=_blank>Kristoffer Johansson</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=/about target=_blank>PGI AB</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Tillbaka till början"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="Visa kommentarer"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.1/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Kopiera till urklipp",maxShownLines:50},comment:{},search:{highlightTag:"em",lunrIndexURL:"/sv/index.json",maxResultLength:10,noResultsFound:"Inga resultat hittades",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>